Veil - Privacy-First Solana Wallet Extension

What it is
----------
Veil is a non-custodial Solana browser extension that puts privacy first. It manages a single locally encrypted master seed and derives site-bound addresses from it. dApps never see your main wallet—you own your on-chain identity and stay protected.

Problem
-------
- On-chain transparency exposes your financial life—every transaction reveals your wallet.
- Address reuse lets observers link your activity across sites and build a complete picture.
- Standard wallets offer zero separation between receiving airdrops, payments, and your main holdings.
- Users want to own their privacy but lack tools that make it the default.

Core Idea
---------
- Privacy by default: Veil protects your identity so you never get exposed.
- One encrypted master seed stored on the user’s device.
- From that seed, Veil deterministically derives site-bound addresses (burner wallets) per origin.
- Each address is isolated, recoverable from the master seed, and never reused once drained.
- dApps only ever interact with a site-bound address, not the master wallet.

Optional: Private Transfers
--------------------------------------
- Burner wallets are the core security—site isolation, no address reuse, keys stay local.
- Veil optionally integrates with a privacy pool for unlinkable on-chain transfers when you need extra privacy.
- Users can enable or disable this in Settings.
- When enabled:
  - Deposit: move funds from burner wallets into a privacy pool for unlinkable transfers.
  - Withdraw: move funds back from the pool to any address, with retry logic for issues like blockhash expiration.
  - Private balance: show a separate “private balance” based on pool UTXOs.

Normal Wallet Behavior
----------------------
- Even without the privacy pool, Veil improves privacy by:
  - Using burner wallets for dApp connections instead of the main wallet.
  - Avoiding address reuse across different sites.
  - Keeping all keys local and never sending them to a backend.
- A background balance monitor periodically checks on-chain balances and updates the UI.
- SOL/USD pricing is fetched via public APIs for better UX.

User Flow with dApps
--------------------
1. The content script injects a provider into the page that plugs into window.solana.providers, coexisting with wallets like Phantom.
2. When a dApp calls connect:
   - If the wallet is locked, the extension popup opens and waits for the user to unlock.
   - Veil creates a pending connection request and surfaces an approval modal.
   - On approval, Veil binds the site to a burner wallet and returns that burner’s public key.
3. After connection:
   - getAccount returns the burner address for that origin.
   - disconnect removes the site from the connected list.
   - signMessage queues a pending sign request that the user must approve in the popup; signing happens with the burner key.
   - signTransaction / signAllTransactions are stubbed as “coming soon” to keep the current release safe and focused.

Architecture
------------
- Manifest V3 extension:
  - Background service worker:
    - Runs the balance monitor.
    - Manages which origins are connected to which burner wallets.
    - Handles provider RPC methods and orchestrates unlock/approval flows.
  - Content script:
    - Injects the provider script into the page (avoiding CSP issues).
    - Bridges messages between the injected provider and the background script.
  - Popup UI (React app):
    - Onboarding: create/import master seed and set password.
    - Home: show active burner wallet, balances (public and private), and quick actions.
    - Settings: toggle optional privacy pool, configure behavior, manage preferences.
    - History and Archived Wallets: view activity and retired burner wallets.

Tech Stack
----------
- Frontend/Popup: React, Vite, TailwindCSS, Framer Motion.
- Blockchain: @solana/web3.js, BIP39 + Ed25519 HD derivation, tweetnacl.
- Optional: Privacy pool integration for unlinkable transfers (when enabled).
- Extension Platform: Chrome Manifest V3, service worker background, content scripts, chrome.storage for encrypted state and session data.
- Language/Tooling: TypeScript, ESLint.

Positioning
-----------
- Category: Privacy tooling for Solana, not a mixer or custodial service.
- Key value proposition: "Privacy by default. Own your on-chain identity." Site-bound addresses and optional privacy pools keep you from getting exposed; burner wallets are the mechanism, not the main pitch.

